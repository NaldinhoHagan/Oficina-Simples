<%- include("../layout", { body: `
  <div class='d-flex justify-content-between align-items-center'>
    <h3 class='mb-0'><i class='bi bi-shield-lock me-2'></i>Usuários</h3>
    <div class='d-flex gap-2'>
      <form class='d-flex' method='get' action='/users'>
        <input class='form-control form-control-sm' name='q' placeholder='Buscar nome'>
        <button class='btn btn-sm btn-outline-secondary ms-2'>Buscar</button>
      </form>
      <a class='btn btn-primary' href='/users/new'>Novo</a>
    </div>
  </div>

  <div class='card shadow-sm card-table mt-3'>
    <div class='table-responsive'>
      <table class='table table-hover mb-0'>
        <thead>
          <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Email</th>
            <th>Perfil</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          ${users.map(u => `
            <tr>
              <td>${u.id}</td>
              <td><a href='/users/${u.id}'>${u.name}</a></td>
              <td>${u.email}</td>
              <td>${u.role}</td>
              <td class='d-flex gap-2'>
                <a class='btn btn-sm btn-outline-warning' href='/users/${u.id}/edit'>
                  <i class='bi bi-pencil-square me-1'></i>Editar
                </a>
                <form method='post' action='/users/${u.id}?_method=DELETE' onsubmit='return confirm("Excluir?")'>
                  <button class='btn btn-sm btn-outline-danger'>
                    <i class='bi bi-trash me-1'></i>Excluir
                  </button>
                </form>
              </td>
            </tr>
          `).join("")}
        </tbody>
      </table>
    </div>
  </div>

  ${pagination ? `
    <nav class='mt-3'>
      <ul class='pagination'>
        ${Array.from({length: pagination.totalPages}, (_,i)=>{
          const p=i+1; const active = p===pagination.page ? "active" : "";
          return `<li class="page-item ${active}"><a class="page-link" href='?page=${p}'>${p}</a></li>`;
        }).join('')}
      </ul>
    </nav>
  ` : ""}
` }) %>